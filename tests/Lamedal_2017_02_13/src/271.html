<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>d:\dev\lamedal\trunk\lamedalcore\lamedalcore\types\list\list_string.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using DocumentFormat.OpenXml.Drawing;
using LamedalCore.domain.Enumerals;
using LamedalCore.zz;

namespace LamedalCore.Types.List
{
    public sealed class List_String
    {
        private readonly LamedalCore_ _lamed = LamedalCore_.Instance; // system library

        ///// &lt;summary&gt;
        ///// Search for a value in a string array.
        ///// &lt;/summary&gt;
        ///// &lt;param name=&quot;array&quot;&gt;The array.&lt;/param&gt;
        ///// &lt;param name=&quot;searchValue&quot;&gt;The search value.&lt;/param&gt;
        ///// &lt;param name=&quot;Index&quot;&gt;The index.&lt;/param&gt;
        ///// &lt;param name=&quot;ignoreCase&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [ignore case].&lt;/param&gt;
        ///// &lt;returns&gt;&lt;/returns&gt;
        //public bool Find_(string[] array, string searchValue, out int Index, bool ignoreCase = true)
        //{
        //    // Word_FromAbbreviation array to lowercase
        //    if (ignoreCase)
        //    {
        //        IList&lt;string&gt; arrayLower = ToLower(array);
        //        return _lamed.Types.List.Find.Index_OfValue(arrayLower, searchValue.ToLower(), out Index);
        //    }
        //    else return _lamed.Types.List.Find.Index_OfValue(array, searchValue.ToLower(), out Index);
        //}

        ///// &lt;summary&gt;
        ///// Finds all occurrences of findStr.
        ///// &lt;/summary&gt;
        ///// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        ///// &lt;param name=&quot;searchList&quot;&gt;The search list. #&lt;/param&gt;
        ///// &lt;param name=&quot;findStr&quot;&gt;The find string.&lt;/param&gt;
        ///// &lt;param name=&quot;caseSensitive&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [case sensitive].&lt;/param&gt;
        ///// &lt;returns&gt;
        /////   &lt;c&gt;true&lt;/c&gt; if XXXX, &lt;c&gt;false&lt;/c&gt; otherwise.
        ///// &lt;/returns&gt;
        //public bool Find_StrValue&lt;T&gt;(IList&lt;T&gt; searchList, string findStr, bool caseSensitive = true)
        //{
        //    List&lt;T&gt; result;
        //    return Find_StrValue&lt;T&gt;(searchList, findStr, out result, caseSensitive);
        //}

        ///// &lt;summary&gt;
        ///// Finds all occurrences of findStr.
        ///// &lt;/summary&gt;
        ///// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        ///// &lt;param name=&quot;searchList&quot;&gt;The search list. #&lt;/param&gt;
        ///// &lt;param name=&quot;findStr&quot;&gt;The find string.&lt;/param&gt;
        ///// &lt;param name=&quot;result&quot;&gt;The result.&lt;/param&gt;
        ///// &lt;param name=&quot;caseSensitive&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [case sensitive].&lt;/param&gt;
        ///// &lt;returns&gt;
        /////   &lt;c&gt;true&lt;/c&gt; if XXXX, &lt;c&gt;false&lt;/c&gt; otherwise.
        ///// &lt;/returns&gt;
        //public bool Find_StrValue&lt;T&gt;(IList&lt;T&gt; searchList, string findStr, out List&lt;T&gt; result, bool caseSensitive = true)
        //{
        //    var searchList2 = new List&lt;T&gt;(searchList);

        //    if (caseSensitive == false)
        //    {
        //        findStr = findStr.ToLower();
        //        result = searchList2.FindAll(delegate (T s) { return s.ToString().ToLower() == (findStr); });
        //    }
        //    else result = searchList2.FindAll(delegate (T s) { return s.ToString() == (findStr); });
        //    return (result.Count &gt; 0);
        //}


        /// &lt;summary&gt;Filters the specified list.&lt;/summary&gt;
        /// &lt;param name=&quot;list&quot;&gt;The project names.&lt;/param&gt;
        /// &lt;param name=&quot;searchStr&quot;&gt;The search string.&lt;/param&gt;
        /// &lt;param name=&quot;returnFound&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [contains].&lt;/param&gt;
        /// &lt;param name=&quot;ignoreCase&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [ignore case].&lt;/param&gt;
        /// &lt;returns&gt;List&amp;lt;System.String&amp;gt;.&lt;/returns&gt;
        public List&lt;string&gt; Find_All(IList&lt;string&gt; list, string searchStr, bool returnFound = true, bool ignoreCase = true)
        {
            StringComparison comparer = (ignoreCase) ? StringComparison.OrdinalIgnoreCase : StringComparison.Ordinal;

            if (searchStr.zIsNullOrEmpty()) return null;
            if (list == null) return null;
            if (list.Count == 0) return null;

            List&lt;string&gt; prjNames;
            if (returnFound) prjNames = new List&lt;string&gt;(list).FindAll(s =&gt; s.IndexOf(searchStr, comparer) &gt;= 0);
            else prjNames = new List&lt;string&gt;(list).FindAll(s =&gt; s.IndexOf(searchStr, comparer) &lt; 0);

            return prjNames;
        }

        /// &lt;summary&gt;Filters the specified list.&lt;/summary&gt;
        /// &lt;param name=&quot;list&quot;&gt;The project names.&lt;/param&gt;
        /// &lt;param name=&quot;searchStr&quot;&gt;The search string.&lt;/param&gt;
        /// &lt;param name=&quot;result&quot;&gt;The result.&lt;/param&gt;
        /// &lt;param name=&quot;returnFound&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [contains].&lt;/param&gt;
        /// &lt;param name=&quot;ignoreCase&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [ignore case].&lt;/param&gt;
        /// &lt;returns&gt;List&amp;lt;System.String&amp;gt;.&lt;/returns&gt;
        public bool Find_All(IList&lt;string&gt; list, string searchStr, out List&lt;string&gt; result, bool returnFound = true, bool ignoreCase = true)
        {
            result = Find_All(list, searchStr, returnFound, ignoreCase);
            if (result == null || result.Count == 0) return false;
            return true;
        }

        /// &lt;summary&gt;Returns the first occurance of an item in a list.&lt;/summary&gt;
        /// &lt;param name=&quot;list&quot;&gt;The project names.&lt;/param&gt;
        /// &lt;param name=&quot;searchStr&quot;&gt;The search string.&lt;/param&gt;
        /// &lt;param name=&quot;returnFound&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [contains].&lt;/param&gt;
        /// &lt;param name=&quot;ignoreCase&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [ignore case].&lt;/param&gt;
        /// &lt;returns&gt;List&amp;lt;System.String&amp;gt;.&lt;/returns&gt;
        public string Find_FirstStr(IList&lt;string&gt; list, string searchStr, bool returnFound = true, bool ignoreCase = true)
        {
            List&lt;string&gt; resultList = Find_All(list, searchStr, returnFound, ignoreCase);

            if (resultList == null || resultList.Count == 0) return null;
            return resultList[0];
        }

        /// &lt;summary&gt;Returns the first occurance of an item in a list.&lt;/summary&gt;
        /// &lt;param name=&quot;list&quot;&gt;The project names.&lt;/param&gt;
        /// &lt;param name=&quot;searchStr&quot;&gt;The search string.&lt;/param&gt;
        /// &lt;param name=&quot;returnFound&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [contains].&lt;/param&gt;
        /// &lt;param name=&quot;ignoreCase&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [ignore case].&lt;/param&gt;
        /// &lt;returns&gt;List&amp;lt;System.String&amp;gt;.&lt;/returns&gt;
        public bool Find_First(IList&lt;string&gt; list, string searchStr, bool returnFound = true, bool ignoreCase = true)
        {
            string retunValue;
            var result = Find_First(list, searchStr, out retunValue, returnFound, ignoreCase);
            return result;
        }

        /// &lt;summary&gt;Returns the first occurance of an item in a list.&lt;/summary&gt;
        /// &lt;param name=&quot;list&quot;&gt;The project names.&lt;/param&gt;
        /// &lt;param name=&quot;searchStr&quot;&gt;The search string.&lt;/param&gt;
        /// &lt;param name=&quot;result&quot;&gt;The result.&lt;/param&gt;
        /// &lt;param name=&quot;returnFound&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [contains].&lt;/param&gt;
        /// &lt;param name=&quot;ignoreCase&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [ignore case].&lt;/param&gt;
        /// &lt;returns&gt;List&amp;lt;System.String&amp;gt;.&lt;/returns&gt;
        public bool Find_First(IList&lt;string&gt; list, string searchStr, out string result, bool returnFound = true, bool ignoreCase = true)
        {
            List&lt;string&gt; resultList = Find_All(list, searchStr, returnFound, ignoreCase);

            if (resultList == null || resultList.Count == 0)
            {
                result = null;
                return false;
            }
            result = resultList[0];
            return true;
        }

        /// &lt;summary&gt;Finds the index in the list. There is some overhead as list is converted to array before search.&lt;/summary&gt;
        /// &lt;param name=&quot;list&quot;&gt;The list.&lt;/param&gt;
        /// &lt;param name=&quot;searchStr&quot;&gt;The search string.&lt;/param&gt;
        /// &lt;param name=&quot;isContained&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [is contained] else do equal test.&lt;/param&gt;
        /// &lt;param name=&quot;ignoreCase&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [ignore case].&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public int Find_Index(IList&lt;string&gt; list, string searchStr, bool isContained = false, bool ignoreCase = true)
        {
            var comparer = (ignoreCase) ? StringComparison.OrdinalIgnoreCase : StringComparison.Ordinal;
            if (isContained) return Array.FindIndex(list.ToArray(), t =&gt; t.IndexOf(searchStr, comparer) &gt;= 0);
            else return Array.FindIndex(list.ToArray(), t =&gt; t.Equals(searchStr, comparer));
        }

        /// &lt;summary&gt;
        /// Replaces the values in the specified array.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;array&quot;&gt;The array.&lt;/param&gt;
        /// &lt;param name=&quot;oldValue&quot;&gt;The old value.&lt;/param&gt;
        /// &lt;param name=&quot;newValue&quot;&gt;The new value.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string[] Replace(string[] array, string oldValue, string newValue)
        {
            var ii = 0;
            var result = new string[array.Length];
            foreach (var item in array) result[ii++] = item.Replace(oldValue, newValue);

            return result;
        }

        /// &lt;summary&gt;
        /// Sorts the by length.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;array&quot;&gt;The array&lt;/param&gt;
        /// &lt;param name=&quot;Acending&quot;&gt;Acending indicator. Default value = true.&lt;/param&gt;
        /// &lt;returns&gt;IEnumerable&lt;string/&gt;&lt;/returns&gt;
        public IEnumerable&lt;string&gt; SortByStrLength(IEnumerable&lt;string&gt; array, bool Acending = true)
        {
            // Use LINQ to sort the array received and return a copy.

            if (Acending)
            {
                var sorted = array.OrderBy(str =&gt; str.Length).ToArray();
                return sorted;
            }
            else
            {
                var sorted = array.OrderByDescending(str =&gt; str.Length).ToArray();
                return sorted;
            }
        }

        /// &lt;summary&gt;Convert list to dictionary.&lt;/summary&gt;
        /// &lt;param name=&quot;list&quot;&gt;The list.&lt;/param&gt;
        /// &lt;param name=&quot;seperator&quot;&gt;The seperator.&lt;/param&gt;
        /// &lt;param name=&quot;reverseOrder&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [reverse order] of the keys and values.&lt;/param&gt;
        /// &lt;param name=&quot;onError&quot;&gt;The on error.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public IDictionary&lt;string, string&gt; ToDictionary(IList&lt;string&gt; list, string seperator = &quot;=&quot;, bool reverseOrder = false,
                        enDuplicateError onError = enDuplicateError.Ignore)
        {
            var result = new Dictionary&lt;string, string&gt;(list.Count); // Replace with longer version
            foreach (string abbr in list)
            {
                var id = abbr.zvar_Id(seperator);
                var value = abbr.zvar_Value(seperator);
                if (reverseOrder)
                     _lamed.Types.Dictionary.Key_AddSafe(result,value,id, onError);
                else _lamed.Types.Dictionary.Key_AddSafe(result, id, value);
            }
            return result;
        }

        /// &lt;summary&gt;
        /// Split string into string array.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;s&quot;&gt;The s.&lt;/param&gt;
        /// &lt;param name=&quot;delimiter&quot;&gt;The delimiter.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public List&lt;string&gt; ToListStr(string inputStr, string delimiter = &quot;♣&quot;)
        {
            inputStr = inputStr.Replace(delimiter, &quot;♣&quot;);
            var list = inputStr.Split(&#39;♣&#39;).ToList();
            return list;
        }

        /// &lt;summary&gt;
        /// Word_FromAbbreviation all values in array is lower case.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;array&quot;&gt;The array.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public IList&lt;string&gt; ToLower(IList&lt;string&gt; array)
        {
            return array.Select(s =&gt; s.ToLowerInvariant()).ToList();
        }

        /// &lt;summary&gt;Word_FromAbbreviation an Array to string.&lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;list&quot;&gt;The array.&lt;/param&gt;
        /// &lt;param name=&quot;delimiter&quot;&gt;The delimiter.&lt;/param&gt;
        /// &lt;param name=&quot;trim&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [trim].&lt;/param&gt;
        /// &lt;param name=&quot;index&quot;&gt;The index.&lt;/param&gt;
        /// &lt;param name=&quot;lastIndex&quot;&gt;The last index. if -1 then it will be up to the last item&lt;/param&gt;
        /// &lt;returns&gt;System.String.&lt;/returns&gt;
        /// &lt;code ShortcutMethod=&quot;ToString&quot;&gt;&lt;/code&gt;
        public string ToString&lt;T&gt;(IList&lt;T&gt; list, string delimiter = &quot;♣&quot;, bool trim = false, int index = 0, int lastIndex = -1)
        {
            if (list == null) return &quot;&quot;;
            if (lastIndex == -1 || lastIndex &gt; list.Count) lastIndex = list.Count;

            var result = new StringBuilder(&quot;&quot;);
            for (var ii = index; ii &lt; lastIndex; ii++)
            {
                string item = list[ii] as string;
                if (trim) item = item.Trim();

                if (ii == index) result.Append(item);
                else result.Append(delimiter + item);
            }
            return result.ToString();
        }

        /// &lt;summary&gt;
        /// Trim left side of all the lines in the array by an equal amount. 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;lines&quot;&gt;The lines array&lt;/param&gt;
        /// &lt;returns&gt;string[]&lt;/returns&gt;
        public string[] TrimLeftRegion(params string[] lines)
        {
            if (lines.Length &lt;= 1) return lines;

            while (lines[1].Length &gt; 0 &amp;&amp; lines[1].Substring(1, 1) == &quot; &quot;)
            {
                for (var ii = 0; ii &lt; lines.Length; ii++)
                {
                    var value = lines[ii];
                    if (value == &quot;&quot;) continue;
                    if (value.Substring(1, 1) == &quot; &quot;) lines[ii] = value.Substring(1);
                    else if (ii != 0) break;
                }
            }
            return lines;
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[87,31,87,43,0],[88,34,88,46,0],[92,18,92,65,0],[92,99,92,101,0],[293,38,293,47,0],[92,65,92,99,0],[83,9,83,10,1],[84,13,84,118,1],[86,13,86,44,1],[86,45,86,57,1],[87,13,87,30,1],[88,13,88,33,1],[91,13,91,29,1],[91,30,91,77,1],[91,112,91,114,1],[94,13,94,29,1],[95,9,95,10,1],[105,9,105,10,1],[106,13,106,73,1],[107,13,107,53,1],[107,54,107,67,1],[108,13,108,25,1],[109,9,109,10,1],[118,9,118,10,1],[119,13,119,90,1],[121,13,121,61,1],[121,62,121,74,1],[122,13,122,34,1],[123,9,123,10,1],[132,9,132,10,1],[134,13,134,95,1],[135,13,135,27,1],[136,9,136,10,1],[146,9,146,10,1],[147,13,147,90,1],[149,13,149,61,1],[150,13,150,14,1],[151,17,151,31,1],[152,17,152,30,1],[154,13,154,36,1],[155,13,155,25,1],[156,9,156,10,1],[165,9,165,10,1],[166,13,166,105,1],[167,13,167,29,1],[167,30,167,74,1],[167,109,167,111,1],[168,18,168,62,1],[168,91,168,93,1],[169,9,169,10,1],[179,9,179,10,1],[180,13,180,24,1],[181,13,181,51,1],[182,13,182,20,1],[182,34,182,39,1],[182,22,182,30,1],[182,41,182,89,1],[182,31,182,33,1],[184,13,184,27,1],[185,9,185,10,1],[194,9,194,10,1],[197,13,197,26,1],[198,13,198,14,1],[199,17,199,51,1],[199,61,199,73,1],[200,17,200,31,1],[203,13,203,14,1],[204,17,204,61,1],[204,71,204,83,1],[205,17,205,31,1],[207,9,207,10,1],[217,9,217,10,1],[218,13,218,69,1],[219,13,219,20,1],[219,37,219,41,1],[219,22,219,33,1],[220,13,220,14,1],[221,17,221,50,1],[222,17,222,56,1],[223,17,223,34,1],[224,22,224,84,1],[225,22,225,77,1],[226,13,226,14,1],[219,34,219,36,1],[227,13,227,27,1],[228,9,228,10,1],[237,9,237,10,1],[238,13,238,57,1],[239,13,239,53,1],[240,13,240,25,1],[241,9,241,10,1],[249,9,249,10,1],[250,13,250,38,1],[250,58,250,69,1],[251,9,251,10,1],[263,9,263,10,1],[264,13,264,30,1],[264,31,264,41,1],[265,13,265,59,1],[265,60,265,83,1],[267,13,267,48,1],[268,18,268,32,1],[269,13,269,14,1],[270,17,270,50,1],[271,17,271,26,1],[271,27,271,46,1],[273,17,273,33,1],[273,34,273,54,1],[274,22,274,54,1],[275,13,275,14,1],[268,50,268,54,1],[268,34,268,48,1],[276,13,276,38,1],[277,9,277,10,1],[285,9,285,10,1],[286,13,286,35,1],[286,36,286,49,1],[289,13,289,14,1],[290,22,290,32,1],[291,17,291,18,1],[292,21,292,43,1],[293,21,293,37,1],[294,21,294,54,1],[294,55,294,86,1],[295,26,295,38,1],[295,39,295,45,1],[296,17,296,18,1],[290,53,290,57,1],[290,34,290,51,1],[297,13,297,14,1],[288,13,288,75,1],[298,13,298,26,1],[299,9,299,10,1],[14,9,14,70,1],[91,77,91,112,1],[167,74,167,109,1],[168,62,168,91,1],[199,51,199,61,1],[204,61,204,71,1],[250,38,250,58,1]]);
    </script>
  </body>
</html>