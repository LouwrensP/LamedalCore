<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>d:\dev\lamedal\trunk\lamedalcore\lamedalcore\lib\io\io_parts.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.IO;
using JetBrains.Annotations;
using LamedalCore.domain.Attributes;
using LamedalCore.domain.Enumerals;
using LamedalCore.zz;

namespace LamedalCore.lib.IO
{
    [BlueprintRule_Class(enBlueprintClassNetworkType.Node_Action, GroupName = &quot;Parts&quot;)]
    public sealed class IO_Parts
    {
        private readonly LamedalCore_ _lamed = LamedalCore_.Instance;

        /// &lt;summary&gt;Return the drive letter for a file path.&lt;/summary&gt;
        /// &lt;param name=&quot;filePath&quot;&gt;The file path.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string Drive(string filePath)
        {
            FileInfo fileInfo = _lamed.lib.IO.File.FileInfo(filePath);
            string drive = Path.GetPathRoot(fileInfo.FullName);
            return _Format2Slash(drive);
        }

        /// &lt;summary&gt;
        /// Returns the directory information for the specified path string.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;folderOrFile&quot;&gt;The path of a file or directory.&lt;/param&gt;
        /// &lt;returns&gt;Directory information for &lt;paramref name=&quot;folderOrFile&quot; /&gt;, or null if &lt;paramref name=&quot;folderOrFile&quot; /&gt; denotes a root directory or is null. Returns &lt;see cref=&quot;F:System.String.Empty&quot; /&gt; if &lt;paramref name=&quot;folderOrFile&quot; /&gt; does not contain directory information.&lt;/returns&gt;
        /// &lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;The &lt;paramref name=&quot;folderOrFile&quot; /&gt; parameter contains invalid characters, is empty, or contains only white spaces.&lt;/exception&gt;
        /// &lt;exception cref=&quot;T:System.IO.PathTooLongException&quot;&gt;NoteIn the .NET for Windows Store apps or the Portable Class Library, catch the base class exception, &lt;see cref=&quot;T:System.IO.IOException&quot; /&gt;, instead.The &lt;paramref name=&quot;folderOrFile&quot; /&gt; parameter is longer than the system-defined maximum length.&lt;/exception&gt;
        [Pure]
        public string Folder(string folderOrFile)
        {
            // If there is no extension -&gt; presume it is a folder
            string result;
            if (folderOrFile.Contains(&quot;.&quot;) == false) result = folderOrFile;
            else result = Path.GetDirectoryName(folderOrFile);
            return _Format2Slash(result);
        }

        /// &lt;summary&gt;Formats the path for easier usage (convert all backslashes to &#39;/&#39;). Used internally&lt;/summary&gt;
        /// &lt;param name=&quot;folder&quot;&gt;The folder.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string _Format2Slash(string folder, int maxExtLength = 4)
        {
            var result = folder.Replace(@&quot;\&quot;, &quot;/&quot;);                 // Convert all &#39;\&#39; to &#39;/&#39; because it is less problematic
            var index = result.LastIndexOf(&#39;.&#39;);
            if (index + maxExtLength+1 &lt; result.Length)
            {
                if (result.zSubStr_Right(1) != &quot;/&quot;) result += &quot;/&quot;; // All folders should end with &#39;/&#39;. This makes it simple to add to it/
            }
            return result;
        }

        /// &lt;summary&gt;
        /// Returns the file name and and path without the extension
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;folderFileAndExt&quot;&gt;The path string from which to obtain the file name and extension.&lt;/param&gt;
        /// &lt;returns&gt;The characters after the last directory character in &lt;paramref name=&quot;folderFileAndExt&quot; /&gt;. If the last character of &lt;paramref name=&quot;folderFileAndExt&quot; /&gt; is a directory or volume separator character, this method returns &lt;see cref=&quot;F:System.String.Empty&quot; /&gt;. If &lt;paramref name=&quot;folderFileAndExt&quot; /&gt; is null, this method returns null.&lt;/returns&gt;
        /// &lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;&lt;paramref name=&quot;folderFileAndExt&quot; /&gt; contains one or more of the invalid characters defined in &lt;see cref=&quot;M:System.IO.Path.GetInvalidPathChars&quot; /&gt;.&lt;/exception&gt;
        [Pure]
        public string FolderAndFile(string folderFileAndExt)
        {
            return Folder(folderFileAndExt) + File_RemoveExtention(folderFileAndExt);
        }

        /// &lt;summary&gt;
        /// Retrun the file part of the specified folderAndFile.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;folderAndFile&quot;&gt;The folderAndFile.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [Pure]
        public string File(string folderAndFile)
        {
            if (folderAndFile.Contains(&quot;.&quot;) == false) return &quot;&quot;;   // All files must have extentions. If there is none then assume it is a folder

            return Path.GetFileName(folderAndFile);
        }

        /// &lt;summary&gt;
        /// Function to return the file without the extention.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;filename&quot;&gt;The folderAndFile&lt;/param&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        [Pure]
        public string File_RemoveExtention(string filename)
        {
            if (filename.Contains(&quot;.&quot;) == false) return &quot;&quot;;   // All files must have extentions. If there is none then assume it is a folder

            return Path.GetFileNameWithoutExtension(filename);
        }

        /// &lt;summary&gt;
        /// Changes the folderAndFile if a URL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;folderAndFile&quot;&gt;The folder and file.&lt;/param&gt;
        /// &lt;param name=&quot;newFileName&quot;&gt;New name of the file.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [Pure]
        public string File_Change(string folderAndFile, string newFileName)
        {
            var folder = Folder(folderAndFile);
            return folder + newFileName;
        }

        /// &lt;summary&gt;
        /// Function to add string to file name.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;folderAndFile&quot;&gt;The folder and file&lt;/param&gt;
        /// &lt;param name=&quot;addThis2Name&quot;&gt;The add this2 name&lt;/param&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string File_Add2Name(string folderAndFile, string addThis2Name)
        {
            string folder, file, ext;
            FolderFileAndExt(folderAndFile, out folder, out file, out ext);

            return folder + file + addThis2Name + ext;
        }



        /// &lt;summary&gt;
        /// Returns the extension of the specified path string.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;folderAndFile&quot;&gt;The path string from which to get the extension.&lt;/param&gt;
        /// &lt;returns&gt;The extension of the specified path (including the period &quot;.&quot;), or null, or &lt;see cref=&quot;F:System.String.Empty&quot; /&gt;. If &lt;paramref name=&quot;folderAndFile&quot; /&gt; is null, &lt;see cref=&quot;M:System.IO.Path.GetExtension(System.IsString)&quot; /&gt; returns null. If &lt;paramref name=&quot;folderAndFile&quot; /&gt; does not have extension information, &lt;see cref=&quot;M:System.IO.Path.GetExtension(System.IsString)&quot; /&gt; returns &lt;see cref=&quot;F:System.IsString.Empty&quot; /&gt;.&lt;/returns&gt;
        /// &lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;&lt;paramref name=&quot;folderAndFile&quot; /&gt; contains one or more of the invalid characters defined in &lt;see cref=&quot;M:System.IO.Path.GetInvalidPathChars&quot; /&gt;.&lt;/exception&gt;
        public string Ext(string folderAndFile)
        {
            return Path.GetExtension(folderAndFile);
        }
        
        /// &lt;summary&gt;
        /// Changes the extension of a path string.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;folderAndFile&quot;&gt;The path information to modify. The path cannot contain any of the characters defined in &lt;see cref=&quot;M:System.IO.Path.GetInvalidPathChars&quot; /&gt;.&lt;/param&gt;
        /// &lt;param name=&quot;newExt&quot;&gt;The new ext.&lt;/param&gt;
        /// &lt;returns&gt;The modified path information.On Windows-based desktop platforms, if &lt;paramref name=&quot;folderAndFile&quot; /&gt; is null or an empty string (&quot;&quot;), the path information is returned unmodified. If &lt;paramref name=&quot;newExt&quot; /&gt; is null, the returned string contains the specified path with its extension removed. If &lt;paramref name=&quot;folderAndFile&quot; /&gt; has no extension, and &lt;paramref name=&quot;newExt&quot; /&gt; is not null, the returned path string contains &lt;paramref name=&quot;newExt&quot; /&gt; appended to the end of &lt;paramref name=&quot;folderAndFile&quot; /&gt;.&lt;/returns&gt;
        /// &lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;&lt;paramref name=&quot;folderAndFile&quot; /&gt; contains one or more of the invalid characters defined in &lt;see cref=&quot;M:System.IO.Path.GetInvalidPathChars&quot; /&gt;.&lt;/exception&gt;
        public string Ext_Change(string folderAndFile, string newExt = &quot;xml&quot;)
        {
            if (newExt == &quot;&quot;) return folderAndFile;
            return Path.ChangeExtension(folderAndFile, newExt);
        }

        /// &lt;summary&gt;
        /// Return the different Parts the specified folder and file.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;folderAndFile&quot;&gt;The folder and file.&lt;/param&gt;
        /// &lt;param name=&quot;folder&quot;&gt;The folder.&lt;/param&gt;
        /// &lt;param name=&quot;file&quot;&gt;The file.&lt;/param&gt;
        /// &lt;param name=&quot;ext&quot;&gt;The ext.&lt;/param&gt;
        public void FolderFileAndExt(string folderAndFile, out string folder, out string file, out string ext)
        {
            folder = Folder(folderAndFile);
            file = File_RemoveExtention(folderAndFile);
            ext = Ext(folderAndFile);
        }

        

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[18,9,18,10,1],[19,13,19,71,1],[20,13,20,64,1],[21,13,21,41,1],[22,9,22,10,1],[33,9,33,10,1],[36,13,36,53,1],[36,54,36,76,1],[37,18,37,63,1],[38,13,38,42,1],[39,9,39,10,1],[45,9,45,10,1],[46,13,46,52,1],[47,13,47,49,1],[48,13,48,56,1],[49,13,49,14,1],[50,17,50,52,1],[50,53,50,67,1],[51,13,51,14,1],[52,13,52,27,1],[53,9,53,10,1],[63,9,63,10,1],[64,13,64,86,1],[65,9,65,10,1],[74,9,74,10,1],[75,13,75,54,1],[75,55,75,65,1],[77,13,77,52,1],[78,9,78,10,1],[87,9,87,10,1],[88,13,88,49,1],[88,50,88,60,1],[90,13,90,63,1],[91,9,91,10,1],[101,9,101,10,1],[102,13,102,48,1],[103,13,103,41,1],[104,9,104,10,1],[113,9,113,10,1],[115,13,115,76,1],[117,13,117,55,1],[118,9,118,10,1],[129,9,129,10,1],[130,13,130,53,1],[131,9,131,10,1],[141,9,141,10,1],[142,13,142,30,1],[142,31,142,52,1],[143,13,143,64,1],[144,9,144,10,1],[154,9,154,10,1],[155,13,155,44,1],[156,13,156,56,1],[157,13,157,38,1],[158,9,158,10,1],[12,9,12,70,1]]);
    </script>
  </body>
</html>