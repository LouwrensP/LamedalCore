<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>d:\dev\lamedal\trunk\lamedalcore\lamedalcore\lib\solutionnt\classnt\classnt_.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using LamedalCore.domain.Attributes;
using LamedalCore.domain.Enumerals;
using LamedalCore.lib.SolutionNT.ClassNT.ClassNTAttribute.ClassNTBlueprintRule;
using LamedalCore.lib.SolutionNT.ClassNT.ClassNTBody.MethodNT;
using LamedalCore.lib.SolutionNT.ClassNT.ClassNTBody.PropertyNT;
using LamedalCore.lib.SolutionNT.ClassNT.ClassNTHeader;
using LamedalCore.lib.SolutionNT.ClassNT.ClassNTStats;
using LamedalCore.zz;

namespace LamedalCore.lib.SolutionNT.ClassNT
{
    [Serializable]
    [BlueprintRule_Class(enBlueprintClassNetworkType.Node_State)]
    [DebuggerDisplay(&quot;Name = {ClassName}&quot;)]
    public sealed class ClassNT_
    {
        public string ClassName; //{ get; private set; } // Readonly refenerece to Classname    
        public string ClassFileName; // { get; private set; } // Readonly refenerece to Class filename                       

        public ClassNTBlueprintRule_ BlueprintRule;   // The Blueprint rules that specify the class features
        public ClassNTHeader_ Header;                 // Class header information  
        public List&lt;MethodNT_&gt; Methods;               // Class methods
        public List&lt;PropertyNT_&gt; Properties;          // Class properties
        public ClassNTStats_ Statistics;              // Statistics about the class
        public List&lt;string&gt; SourceCode;               // Source code of the class body 
        //[XmlIgnore]
        //public ProjectNT_ ParentProject;

        public static ClassNT_ Create(List&lt;string&gt; sourceLines, out bool error, out ClassNTBlueprintRule_ blueprintRule, string classFilename = &quot;&quot;/*, ProjectNT_ project = null */)
        {
            var result = new ClassNT_(); // {Name = name, Value = value};
            // Execute static method to populate result parameters
            int ii = 0;
            result.SourceCode = sourceLines.ToList();
            ClassNT_Methods.Parse_Class(sourceLines, ref ii, result, out error, out result.Header, out result.Methods, out result.Properties, out result.Statistics, out result.BlueprintRule);
            blueprintRule = result.BlueprintRule;
            result.ClassName = result.Header.ClassName;
            result.ClassFileName = classFilename;
            //result.ParentProject = project;
            return result;
        }

        public static ClassNT_ Create(string classFile, out bool error, out ClassNTBlueprintRule_ blueprintRule /*,ProjectNT_ project = null*/)
        {
            blueprintRule = null;
            if (1f.zIO().File.Exists(classFile) == false) &quot;Error! File &#39;{0}&#39; does not exists.&quot;.zFormat(classFile).zException_Show();

            string[] codeLines = 1f.zIO().RW.File_Read2StrArray(classFile);
            return ClassNT_.Create(codeLines.ToList(), out error, out blueprintRule, classFile/*, project*/);
        }

        //public static ClassNT_ Create(CodeClass2 codeClass, out bool error, out ClassNTBlueprintRule_ blueprintRule)
        //{
        //    string classFile = codeClass.FullName;
        //    return ClassNT_.Create(classFile, out error, out blueprintRule);
        //}


        /// &lt;summary&gt;Search for a Method.&lt;/summary&gt;
        /// &lt;param name=&quot;searchStr&quot;&gt;The search string.&lt;/param&gt;
        /// &lt;param name=&quot;delete&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [delete] the method.&lt;/param&gt;
        /// &lt;returns&gt;MethodNT_&lt;/returns&gt;
        public MethodNT_ Method_Find(string searchStr, bool delete = false)
        {
            // Need to remove all enters and spaces after the enter
            var list = searchStr.zConvert_Str_ToListStr(&quot;&quot;.NL());

            var searchStr2 = list.zTo_Str(&quot;&quot;, true);
            foreach (MethodNT_ method in Methods)
            {
                var header = method.Header.Method_HeaderLine;
                //var header = method.ToString();
                if (header != searchStr2) continue;  // This way is less nesting; method.ToString() is method + parameters

                if (delete) Methods.Remove(method);
                return method;
            }
            return null;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[34,9,34,10,1],[35,13,35,41,1],[37,13,37,24,1],[38,13,38,54,1],[39,13,39,192,1],[40,13,40,50,1],[41,13,41,56,1],[42,13,42,50,1],[44,13,44,27,1],[45,9,45,10,1],[48,9,48,10,1],[49,13,49,34,1],[50,13,50,58,1],[50,59,50,133,1],[52,13,52,76,1],[53,13,53,110,1],[54,9,54,10,1],[68,9,68,10,1],[70,13,70,66,1],[72,13,72,53,1],[73,13,73,20,1],[73,42,73,49,1],[73,22,73,38,1],[74,13,74,14,1],[75,17,75,62,1],[77,17,77,42,1],[77,43,77,52,1],[79,17,79,28,1],[79,29,79,52,1],[80,17,80,31,1],[73,39,73,41,1],[82,13,82,25,1],[83,9,83,10,1]]);
    </script>
  </body>
</html>