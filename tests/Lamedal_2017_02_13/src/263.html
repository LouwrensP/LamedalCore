<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>d:\dev\lamedal\trunk\lamedalcore\lamedalcore\types\string\string_word.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using JetBrains.Annotations;
using LamedalCore.domain.Attributes;
using LamedalCore.domain.Enumerals;
using LamedalCore.zz;

namespace LamedalCore.Types.String
{
    /// &lt;summary&gt;
    /// Actions of sentences and words
    /// &lt;/summary&gt;
    [BlueprintRule_Class(enBlueprintClassNetworkType.Node_Action, DefaultType = typeof(string), GroupName = &quot;Str&quot;)]
    public sealed class String_Word
    {
        private readonly LamedalCore_ _lamed = LamedalCore_.Instance;

        /// &lt;summary&gt;Return the last word substring from the input string. The space character is customisable.&lt;/summary&gt;
        /// &lt;param name=&quot;sentence&quot;&gt;The input string&lt;/param&gt;
        /// &lt;param name=&quot;delimiter&quot;&gt;The delimiter setting. Default inputStr = &quot; &quot;.&lt;/param&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        [Pure]
        public string Word_Last(string sentence, string delimiter = &quot; &quot;)
        {
            if (sentence.zIsNullOrEmpty()) return &quot;&quot;;
            return sentence.Substring(sentence.LastIndexOf(delimiter) + 1);
        }

        /// &lt;summary&gt;Removes the last word from the input string.&lt;/summary&gt;
        /// &lt;param name=&quot;inputStr&quot;&gt;The input string&lt;/param&gt;
        /// &lt;param name=&quot;delimiter&quot;&gt;The delimiter setting. Default value = &quot; &quot;.&lt;/param&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string Word_LastWord_Remove(string inputStr, string delimiter = &quot; &quot;)
        {
            var lastWord = Word_Last(inputStr, delimiter);
            var len = inputStr.Length - lastWord.Length;
            var result = inputStr.Substring(0, len);
            result = _lamed.Types.String.Edit.Remove_StrAtEnd(result, delimiter);
            return result;
        }

        /// &lt;summary&gt;Removes the adjacent duplicates words from the sentence.&lt;/summary&gt;
        /// &lt;param name=&quot;sentence&quot;&gt;The sentence&lt;/param&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string Word_RemoveAdjacentDuplicates(string sentence)
        {
            var words = sentence.zConvert_Array_FromStr(&quot; &quot;).ToList();
            var resultList = new List&lt;string&gt;();
            var word0 = &quot;&quot;;
            for (var ii = 0; ii &lt; words.Count; ii++)
            {
                var word1 = words[ii];
                if (word1 != word0) resultList.Add(word1);
                word0 = word1;
            }
            var result = resultList.zTo_Str(&quot; &quot;);
            return result;
        }

        /// &lt;summary&gt;Count the total items contained in the input string.&lt;/summary&gt;
        /// &lt;param name=&quot;sentence&quot;&gt;The input string.&lt;/param&gt;
        /// &lt;param name=&quot;word2Search&quot;&gt;The search pattern.&lt;/param&gt;
        /// &lt;returns&gt;
        /// int
        /// &lt;/returns&gt;
        [Pure]
        public int Word_Total(string sentence, string word2Search)
        {
            int count = 0, n = 0;

            if (word2Search != &quot;&quot;)
            {
                while ((n = sentence.IndexOf(word2Search, n, StringComparison.CurrentCultureIgnoreCase)) != -1)
                {
                    n += word2Search.Length;
                    ++count;
                }
            }
            return count;
        }

        /// &lt;summary&gt;
        /// Converts the input text to camel case words string. booBa -&gt; boo Ba
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;camelCaseWord&quot;&gt;The input string&lt;/param&gt;
        /// &lt;param name=&quot;convert2Lower&quot;&gt;To lower indicator. Default value = false.&lt;/param&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        [Pure]
        public string Word_Words_FromCamelCase(string camelCaseWord, bool convert2Lower = false)
        {
            // Break sentence up in words
            var result = &quot;&quot;;
            var previousIsLower = false;
            foreach (char c in camelCaseWord)
            {
                if ((c &gt;= 65 &amp;&amp; c &lt;= 90))     // A..Z
                {
                    if (previousIsLower) result += &quot; &quot;;    // Only split if uppercase follows lowercase
                    previousIsLower = false;
                }
                else previousIsLower = true;

                result += c;
            }
            if (convert2Lower) result = result.ToLower();  // Lowercase the words

            return result.Trim();
        }

        
        /// &lt;summary&gt;Splits the sentance on the last word. Words are identified by the space parameter.&lt;/summary&gt;
        /// &lt;param name=&quot;sentence&quot;&gt;The sentence&lt;/param&gt;
        /// &lt;param name=&quot;firstPart&quot;&gt;Return the first part&lt;/param&gt;
        /// &lt;param name=&quot;lastPart&quot;&gt;Return the last part&lt;/param&gt;
        /// &lt;param name=&quot;space&quot;&gt;The space setting. Default value = &quot; &quot;.&lt;/param&gt;
        public void Word_SplitOnLast(string sentence, out string firstPart, out string lastPart, string space = &quot; &quot;)
        {
            var words = sentence.zConvert_Array_FromStr(space);
            var total = words.Count;
            firstPart = words.zTo_Str(space, 0, total - 1);
            lastPart = words[total - 1];
        }

        /// &lt;summary&gt;
        /// Replaces the input string by swapping the last underscore words.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;inputStr&quot;&gt;The input string.&lt;/param&gt;
        /// &lt;returns&gt;
        /// string
        /// &lt;/returns&gt;
        [Pure]
        public string Word_SwapLast2UnderscoreWords(string inputStr)
        {
            if (inputStr.Contains(&quot;_&quot;) == false) return inputStr;

            var result = &quot;&quot;;
            var words = inputStr.Split(&#39;_&#39;);
            for (var ii = 0; ii &lt; words.Length - 2; ii++)
            {
                if (result == &quot;&quot;) result += words[ii];
                else result += &quot; &quot; + words[ii];
            }

            // Only swap the last 2 words
            if (result != &quot;&quot;) result += &quot; &quot;;
            result += words[words.Length - 1] + &quot; &quot;;
            result += words[words.Length - 2];

            return result;
        }

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[26,9,26,10,1],[27,13,27,43,1],[27,44,27,54,1],[28,13,28,76,1],[29,9,29,10,1],[36,9,36,10,1],[37,13,37,59,1],[38,13,38,57,1],[39,13,39,53,1],[40,13,40,82,1],[41,13,41,27,1],[42,9,42,10,1],[48,9,48,10,1],[49,13,49,71,1],[50,13,50,49,1],[51,13,51,28,1],[52,18,52,28,1],[53,13,53,14,1],[54,17,54,39,1],[55,17,55,36,1],[55,37,55,59,1],[56,17,56,31,1],[57,13,57,14,1],[52,48,52,52,1],[52,30,52,46,1],[58,13,58,50,1],[59,13,59,27,1],[60,9,60,10,1],[70,9,70,10,1],[71,13,71,26,1],[71,28,71,33,1],[73,13,73,35,1],[74,13,74,14,1],[76,17,76,18,1],[77,21,77,45,1],[78,21,78,29,1],[79,17,79,18,1],[75,17,75,112,1],[80,13,80,14,1],[81,13,81,26,1],[82,9,82,10,1],[92,9,92,10,1],[94,13,94,29,1],[95,13,95,41,1],[96,13,96,20,1],[96,32,96,45,1],[96,22,96,28,1],[97,13,97,14,1],[98,17,98,42,1],[99,17,99,18,1],[100,21,100,41,1],[100,42,100,56,1],[101,21,101,45,1],[102,17,102,18,1],[103,22,103,45,1],[105,17,105,29,1],[106,13,106,14,1],[96,29,96,31,1],[107,13,107,31,1],[107,32,107,58,1],[109,13,109,34,1],[110,9,110,10,1],[119,9,119,10,1],[120,13,120,64,1],[121,13,121,37,1],[122,13,122,60,1],[123,13,123,41,1],[124,9,124,10,1],[135,9,135,10,1],[136,13,136,49,1],[136,50,136,66,1],[138,13,138,29,1],[139,13,139,45,1],[140,18,140,28,1],[141,13,141,14,1],[142,17,142,34,1],[142,35,142,55,1],[143,22,143,48,1],[144,13,144,14,1],[140,53,140,57,1],[140,30,140,51,1],[147,13,147,30,1],[147,31,147,45,1],[148,13,148,53,1],[149,13,149,47,1],[151,13,151,27,1],[152,9,152,10,1],[18,9,18,70,1]]);
    </script>
  </body>
</html>