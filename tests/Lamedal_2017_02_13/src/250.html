<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>d:\dev\lamedal\trunk\lamedalcore\lamedalcore\types\types_enum.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Reflection;
using JetBrains.Annotations;
using LamedalCore.domain.Attributes;
using LamedalCore.domain.Enumerals;
using LamedalCore.zz;

namespace LamedalCore.Types
{
    [BlueprintRule_Class(enBlueprintClassNetworkType.Node_Action, DefaultType = typeof(Enum), GroupName = &quot;Enum&quot;, ShortcutClass = &quot;Enum_Blueprint&quot;)]
    public sealed class Types_Enum
    {
        private readonly LamedalCore_ _lamed = LamedalCore_.Instance; // system library

        /// &lt;summary&gt;
        /// Test if type is IsEnumerable.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;type&quot;&gt;The type.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [Pure]
        public bool IsEnumerable(Type type)
        {
            TypeInfo typeInfo = type.GetTypeInfo();
            return typeInfo.IsEnum;

            //if (type.ReflectedType == null) return type.IsEnum;
            //return type.ReflectedType == typeof(IsEnumerable);
        }

        /// &lt;summary&gt;
        /// Convert enumeral string value to the enumeral type value.
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;value&quot;&gt;The value&lt;/param&gt;
        /// &lt;param name=&quot;ignoreCase&quot;&gt;Ignore case indicator. Default value = false.&lt;/param&gt;
        /// &lt;param name=&quot;ignoreStrPart&quot;&gt;The ignore string part.&lt;/param&gt;
        /// &lt;returns&gt;
        /// T
        /// &lt;/returns&gt;
        /// &lt;code Shortcut=&quot;Enums&quot;&gt;&lt;/code&gt;
        public T Str_2EnumValue&lt;T&gt;(string value, bool ignoreCase = false, string ignoreStrPart = &quot;&quot;)
        {
            var result = Str_2EnumValue(value, typeof(T), ignoreCase, ignoreStrPart);
            // if (result == null) return default(T);  // Unable to create unit test for this condition.

            return (T)result;
        }

        /// &lt;summary&gt;
        /// Convert the object value to Enumeral value.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;objectValue&quot;&gt;The object value&lt;/param&gt;
        /// &lt;param name=&quot;type&quot;&gt;The type&lt;/param&gt;
        /// &lt;param name=&quot;ignoreCase&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [ignore case].&lt;/param&gt;
        /// &lt;param name=&quot;ignoreStrPart&quot;&gt;The ignore string part.&lt;/param&gt;
        /// &lt;returns&gt;
        /// object
        /// &lt;/returns&gt;
        public object Object_2EnumValue(object objectValue, Type type, bool ignoreCase = false, string ignoreStrPart = &quot;&quot;)
        {
            string objectStr = objectValue.zObject().AsStr();
            return Str_2EnumValue(objectStr, type, ignoreCase, ignoreStrPart);
        }

        /// &lt;summary&gt;
        /// Word_FromAbbreviation the object value to Enumeral value.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;value&quot;&gt;The object string.&lt;/param&gt;
        /// &lt;param name=&quot;type&quot;&gt;The type&lt;/param&gt;
        /// &lt;param name=&quot;ignoreCase&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [ignore case].&lt;/param&gt;
        /// &lt;param name=&quot;ignoreStrPart&quot;&gt;The ignore string part.&lt;/param&gt;
        /// &lt;returns&gt;
        /// object
        /// &lt;/returns&gt;
        public object Str_2EnumValue(string value, Type type, bool ignoreCase = false, string ignoreStrPart = &quot;&quot;)
        {
            // Check parameters
            if (ignoreStrPart != &quot;&quot;) value = value.Replace(ignoreStrPart, &quot;&quot;);
            if (value != null &amp;&amp; value.Contains(&quot;.&quot;))
            {
                var valueOld = value;
                var typeName = valueOld.zvar_Id(&quot;.&quot;);
                value = valueOld.zvar_Value(&quot;.&quot;);
                if (typeName != type.Name) throw new ArgumentException($&quot;Error! &#39;{value}&#39; is not part of &#39;{type.Name}&#39;.&quot;, nameof(value));
            }

            // Try the conversion
            try
            {
                var result = Enum.Parse(type, value, ignoreCase);
                return result;
            }
            catch (Exception e)
            {
                Debug.WriteLine(e);
                var typeName = type.ToString();
                var errMsg = &quot;ERROR: Value &#39;{0}&#39; was not found in type {1}&quot;.zFormat(value, typeName);
                e.zException_Show(errMsg, enExceptionAction.reThrowError);
            }
            return null;
            //var result2 = Convert.ChangeType(null, type);
            //return result2;
        }

        /// &lt;summary&gt;
        /// Converts enumeral to IList. &lt;br&gt;&lt;/br&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;list&quot;&gt;The list.&lt;/param&gt;
        /// &lt;param name=&quot;enumToConvert&quot;&gt;typeof(myEnum) &lt;br&gt;&lt;/br&gt; The enum to convert.&lt;/param&gt;
        /// &lt;param name=&quot;clearList&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [clear list].&lt;/param&gt;
        /// &lt;param name=&quot;prefix&quot;&gt;The prefix.&lt;/param&gt;
        /// &lt;param name=&quot;postfix&quot;&gt;The postfix.&lt;/param&gt;
        /// &lt;param name=&quot;replaceUnderscoreWith&quot;&gt;The replace underscore with.&lt;/param&gt;
        /// &lt;code&gt;CTIM_Generation;&lt;/code&gt;
        public void enum_2IList(Type enumToConvert, IList list, bool clearList = true, string prefix = &quot;&quot;, string postfix = &quot;&quot;, string replaceUnderscoreWith = &quot;_&quot;)
        {
            //=================
            // Generated @ 2015/02/03
            // Generated from &#39;Blueprint.Rules.Types.Copy_To&#39;() -&gt; the parameter order was changed to ensure better MTIN results after transformations.
            enum_2IList(list, enumToConvert, clearList, prefix, postfix, replaceUnderscoreWith);
        }
        /// &lt;summary&gt;
        /// Converts enumeral to IList. &lt;br&gt;&lt;/br&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;list&quot;&gt;The list.&lt;/param&gt;
        /// &lt;param name=&quot;enumToConvert&quot;&gt;typeof(myEnum) &lt;br&gt;&lt;/br&gt; The enum to convert.&lt;/param&gt;
        /// &lt;param name=&quot;clearList&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [clear list].&lt;/param&gt;
        /// &lt;param name=&quot;prefix&quot;&gt;The prefix.&lt;/param&gt;
        /// &lt;param name=&quot;postfix&quot;&gt;The postfix.&lt;/param&gt;
        /// &lt;param name=&quot;replaceUnderscoreWith&quot;&gt;The replace underscore with.&lt;/param&gt;
        /// &lt;code Shortcut=&quot;Enums&quot; GenerateParameter1=&quot;enumToConvert&quot;&gt;&lt;/code&gt;
        public void enum_2IList(IList list, Type enumToConvert, bool clearList = true, string prefix = &quot;&quot;, string postfix = &quot;&quot;, string replaceUnderscoreWith = &quot;_&quot;)
        {
            _lamed.Types.List.Convert.IList_FromEnum(list, enumToConvert, clearList, prefix, postfix, replaceUnderscoreWith);
        }

        /// &lt;summary&gt;
        /// Converts enumeral to string array.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;enumToConvert&quot;&gt;Enumeral to converts the&lt;/param&gt;
        /// &lt;param name=&quot;prefix&quot;&gt;The prefix.&lt;/param&gt;
        /// &lt;param name=&quot;postfix&quot;&gt;The postfix.&lt;/param&gt;
        /// &lt;param name=&quot;replaceUnderscoreWith&quot;&gt;The replace underscore with.&lt;/param&gt;
        /// &lt;returns&gt;
        /// string[]
        /// &lt;/returns&gt;
        public string[] enum_2ArrayStr(Type enumToConvert, string prefix = &quot;&quot;, string postfix = &quot;&quot;, string replaceUnderscoreWith = &quot;_&quot;)
        {
            var list = new List&lt;string&gt;();
            enum_2IList(list, enumToConvert, false, prefix, postfix, replaceUnderscoreWith);
            return list.ToArray();
        }

        /// &lt;summary&gt;
        /// Function to get the value of the enumerator.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;enumValue&quot;&gt;The enumber&lt;/param&gt;
        /// &lt;returns&gt;string&lt;/returns&gt;
        public string enum_Description(Enum enumValue)
        {
            // Add [Description(&quot;&quot;)] flag to enumeral

            Type enumType = enumValue.GetType();
            string enumStr = enumValue.ToString();
            FieldInfo fieldInfo = enumType.GetRuntimeField(enumStr);
            Type attributeType = typeof(BlueprintData_DescriptionAttribute);
            var attributes = (BlueprintData_DescriptionAttribute[])fieldInfo.GetCustomAttributes(attributeType, false);

            return (attributes.Length &gt; 0) 
                        ? attributes[0].Description 
                        : enumValue.ToString();
        }


        #region Flag_IsSet

        /// &lt;summary&gt;
        /// Determines whether the bit field are set in the 
        /// current instance.
        /// &lt;/summary&gt;
        public bool Flag_IsSet(Enum value, Enum flag1)
        {
            return value.HasFlag(flag1);
        }

        /// &lt;summary&gt;
        /// Determines whether any of the given bit fields are set in the
        /// current instance.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;enumValue&quot;&gt;The enum value.&lt;/param&gt;
        /// &lt;param name=&quot;andEvaluation&quot;&gt;if set to &lt;c&gt;false&lt;/c&gt; then check of any flag.If set to &lt;c&gt;true&lt;/c&gt; tests for all values.&lt;/param&gt;
        /// &lt;param name=&quot;enumFlags&quot;&gt;The enum value.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool Flag_IsSet(Enum enumValue, bool andEvaluation = false, params Enum[] enumFlags)
        {
            bool result;
            if (andEvaluation)
            {
                // And ]========================
                result = true;
                foreach (Enum enum1 in enumFlags)
                {
                    if (enumValue.HasFlag(enum1) == false)
                    {
                        result = false;
                        break;  // &lt;------------------------------------------
                    }
                }
            }
            else
            {
                // Or ]==========================
                result = false;
                foreach (Enum enum1 in enumFlags)
                {
                    if (enumValue.HasFlag(enum1))
                    {
                        result = true;
                        break; // &lt;------------------------------------------
                    }
                }  
            }
            return result;

        }
        #endregion

        /// &lt;summary&gt;
        /// Returns a sequence of the enumeration members that are flagged
        /// in the given enumeration value.
        /// &lt;/summary&gt;
        /// &lt;exception cref=&quot;NotSupportedException&quot;&gt;
        /// &lt;typeparam name=&quot;T&quot;/&gt; is not an enumeration.
        /// &lt;/exception&gt;
        /// &lt;exception cref=&quot;ArgumentException&quot;&gt;
        /// The &lt;paramref name=&quot;value&quot;/&gt; argument is not an instance of 
        /// the enumeration &lt;typeparamref name=&quot;T&quot;/&gt;.
        /// &lt;/exception&gt;
        public IEnumerable&lt;T&gt; Flags&lt;T&gt;(Enum value)
        {

            var type = value.GetType();
            var typeInfo = type.GetTypeInfo();

            if (!typeof(T).GetTypeInfo().IsEnum)
            {
                throw new NotSupportedException(string.Format(
                    @&quot;{0} is not an enumeration and therefore an invalid type argument for {1}.&quot;,
                    typeof(T), &quot;Flags&quot;));
            }

            TypeInfo typeInfoTest = typeof (T).GetTypeInfo();
            if (!typeInfoTest.IsAssignableFrom(typeInfo)) throw new ArgumentException(null, &quot;value&quot;);

            return typeInfo.IsDefined(typeof(FlagsAttribute), false)
                 ? from Enum flag in Enum.GetValues(type)
                   where value.HasFlag(flag)
                   select (T)(object)flag
                 : Enum.IsDefined(type, value)
                 ? Enumerable.Repeat((T)(object)value, 1)
                 : Enumerable.Empty&lt;T&gt;();
        }

        /// &lt;summary&gt;
        /// Add a flag to an enum
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;type&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public T Flag_Add&lt;T&gt;(Enum type, T value)
        {
            T result = default(T);
            var underlyingType = Enum.GetUnderlyingType(value.GetType());
            try
            {
                if (underlyingType == typeof(int))
                {
                    result =(T)(object)(((int)(object)type | (int)(object)value));
                }
                else if (underlyingType == typeof(uint))
                {
                    result = (T)(object)(((uint)(object)type | (uint)(object)value));
                }
            } 
            catch (Exception ex)
                  {ex.zException_Show($&quot;Could not append value &#39;{value}&#39; to enumerated type &#39;typeof(T).Name)&#39;.&quot;);}
            return result;
        }

        /// &lt;summary&gt;
        /// Remove a flag from an enum type
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;type&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public T Flag_Remove&lt;T&gt;(Enum type, T value)
        {
            T result = default(T);
            var underlyingType = Enum.GetUnderlyingType(value.GetType());
            try
            {
                if (underlyingType == typeof(int))
                {
                    result = (T)(object)(((int)(object)type &amp; ~(int)(object)value));
                }
                else if (underlyingType == typeof(uint))
                {
                    result = (T)(object)(((uint)(object)type &amp; ~(uint)(object)value));
                }
            }
            catch (Exception ex)
                  {ex.zException_Show($&quot;Could not remove value &#39;{value}&#39; from enumerated type &#39;{typeof(T).Name}&#39;.&quot;);}

            return result;
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[88,44,88,138,0],[103,13,103,14,0],[104,13,104,25,0],[225,17,225,18,0],[250,13,250,14,0],[251,17,253,42,0],[257,59,257,102,0],[289,13,289,33,0],[290,19,290,20,0],[290,20,290,114,0],[290,114,290,115,0],[315,13,315,33,0],[316,19,316,20,0],[316,20,316,117,0],[316,117,316,118,0],[26,9,26,10,1],[27,13,27,52,1],[28,13,28,36,1],[32,9,32,10,1],[46,9,46,10,1],[47,13,47,86,1],[50,13,50,30,1],[51,9,51,10,1],[64,9,64,10,1],[65,13,65,62,1],[66,13,66,79,1],[67,9,67,10,1],[80,9,80,10,1],[82,13,82,37,1],[82,38,82,79,1],[83,13,83,54,1],[84,13,84,14,1],[85,17,85,38,1],[86,17,86,54,1],[87,17,87,50,1],[88,17,88,43,1],[89,13,89,14,1],[93,13,93,14,1],[94,17,94,66,1],[95,17,95,31,1],[97,13,97,32,1],[98,13,98,14,1],[99,17,99,36,1],[100,17,100,48,1],[101,17,101,102,1],[102,17,102,75,1],[107,9,107,10,1],[120,9,120,10,1],[124,13,124,97,1],[125,9,125,10,1],[137,9,137,10,1],[138,13,138,126,1],[139,9,139,10,1],[152,9,152,10,1],[153,13,153,43,1],[154,13,154,93,1],[155,13,155,35,1],[156,9,156,10,1],[164,9,164,10,1],[167,13,167,49,1],[168,13,168,51,1],[169,13,169,69,1],[170,13,170,77,1],[171,13,171,120,1],[173,13,175,48,1],[176,9,176,10,1],[186,9,186,10,1],[187,13,187,41,1],[188,9,188,10,1],[199,9,199,10,1],[201,13,201,31,1],[202,13,202,14,1],[204,17,204,31,1],[205,17,205,24,1],[205,40,205,49,1],[205,26,205,36,1],[206,17,206,18,1],[207,21,207,59,1],[208,21,208,22,1],[209,25,209,40,1],[210,25,210,31,1],[212,17,212,18,1],[205,37,205,39,1],[213,13,213,14,1],[215,13,215,14,1],[217,17,217,32,1],[218,17,218,24,1],[218,40,218,49,1],[218,26,218,36,1],[219,17,219,18,1],[220,21,220,50,1],[221,21,221,22,1],[222,25,222,39,1],[223,25,223,31,1],[218,37,218,39,1],[226,13,226,14,1],[227,13,227,27,1],[229,9,229,10,1],[244,9,244,10,1],[246,13,246,40,1],[247,13,247,47,1],[249,13,249,49,1],[256,13,256,62,1],[257,13,257,58,1],[259,13,261,26,1],[261,45,262,27,1],[262,42,265,42,1],[266,9,266,10,1],[275,9,275,10,1],[276,13,276,35,1],[277,13,277,74,1],[279,13,279,14,1],[280,17,280,51,1],[281,17,281,18,1],[282,21,282,83,1],[283,17,283,18,1],[284,22,284,57,1],[285,17,285,18,1],[286,21,286,86,1],[287,17,287,18,1],[288,13,288,14,1],[291,13,291,27,1],[292,9,292,10,1],[301,9,301,10,1],[302,13,302,35,1],[303,13,303,74,1],[305,13,305,14,1],[306,17,306,51,1],[307,17,307,18,1],[308,21,308,85,1],[309,17,309,18,1],[310,22,310,57,1],[311,17,311,18,1],[312,21,312,87,1],[313,17,313,18,1],[314,13,314,14,1],[318,13,318,27,1],[319,9,319,10,1],[17,9,17,70,1],[261,26,261,45,1],[262,27,262,42,1]]);
    </script>
  </body>
</html>