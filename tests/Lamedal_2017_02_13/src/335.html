<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>d:\dev\lamedal\trunk\lamedalcore\lamedalcore\lib\io\io_rw.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.IO;
using System.Linq;
using System.Reflection;
using LamedalCore.domain.Attributes;
using LamedalCore.domain.Enumerals;
using LamedalCore.lib.Excel;
using LamedalCore.zz;

namespace LamedalCore.lib.IO
{
    [BlueprintRule_Class(enBlueprintClassNetworkType.Node_Action)]
    public sealed class IO_RW
    {
        private readonly IO_ _io = LamedalCore_.Instance.lib.IO;


        #region Excel
        /// &lt;summary&gt;
        /// Gets the RW library methods.
        /// &lt;/summary&gt;
        public Excel_IO_Read Excel
        {
            get { return _Excel ?? (_Excel = new Excel_IO_Read()); }
        }
        // This inclusion is an exception to the rule.
        private Excel_IO_Read _Excel;
        #endregion

        /// &lt;summary&gt;Write to file name&lt;/summary&gt;
        /// &lt;param name=&quot;pathAndFile&quot;&gt;The path and file.&lt;/param&gt;
        /// &lt;param name=&quot;txt&quot;&gt;The text.&lt;/param&gt;
        /// &lt;param name=&quot;overwrite&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [overwrite].&lt;/param&gt;
        /// &lt;param name=&quot;append&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [append].&lt;/param&gt;
        public void File_Write(string pathAndFile, string txt, bool overwrite = false, bool append = false)
        {
            if (append)
            {
                if (overwrite)
                    &quot;Error! It is not possible to append and overwrite the file at the same time.&quot;.zException_Show();

                if (_io.File.Exists(pathAndFile)) txt = &quot;&quot;.NL() + txt; // Add extra space into file
                File.AppendAllText(pathAndFile, txt);
            }
            else
            {
                if (overwrite == false &amp;&amp; _io.File.Exists(pathAndFile)) &quot;Error! Can not write to file because it already exists.&quot;.zException_Show();
                File.WriteAllText(pathAndFile, txt);
            }
        }

        /// &lt;summary&gt;Write to file name&lt;/summary&gt;
        /// &lt;param name=&quot;pathAndFile&quot;&gt;The path and file.&lt;/param&gt;
        /// &lt;param name=&quot;lines&quot;&gt;The lines.&lt;/param&gt;
        /// &lt;param name=&quot;overwrite&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [overwrite].&lt;/param&gt;
        /// &lt;param name=&quot;append&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [append].&lt;/param&gt;
        public void File_Write(string pathAndFile, string[] lines, bool overwrite = false, bool append = false)
        {
            var txt = lines.zTo_Str(&quot;&quot;.NL());
            File_Write(pathAndFile, txt, overwrite: overwrite, append: append);

            //var list = lines.ToList();
            //if (append) File.AppendAllLines(pathAndFile, lines);
            //else File.WriteAllLines(pathAndFile, list);
        }

        /// &lt;summary&gt;Read the contents of the file.&lt;/summary&gt;
        /// &lt;param name=&quot;pathAndFile&quot;&gt;The path and file.&lt;/param&gt;
        /// &lt;param name=&quot;errorIfNoExist&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [error if no exist].&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string File_Read2Str(string pathAndFile, bool errorIfNoExist = true)
        {
            string result;
            if (errorIfNoExist == false)
            {
                if (_io.File.Exists(pathAndFile) == false) return &quot;&quot;;   // File does not exists &amp; this is ok
            }
            try
            {
                result = File.ReadAllText(pathAndFile);
            }
            catch (Exception ex)
            {
                
                var msg = _io.Parts._Format2Slash(ex.Message);
                throw new FileNotFoundException(msg, ex);
            }
            return result;
        }

        public string[] File_Read2StrArray(string pathAndFile)
        {
            var Return = File.ReadAllLines(pathAndFile);
            return Return;
        }

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[24,17,24,18,0],[24,19,24,67,0],[24,68,24,69,0],[47,73,47,149,0],[36,9,36,10,1],[37,13,37,24,1],[38,13,38,14,1],[39,17,39,31,1],[40,21,40,118,1],[42,17,42,50,1],[42,51,42,71,1],[43,17,43,54,1],[44,13,44,14,1],[46,13,46,14,1],[47,17,47,72,1],[48,17,48,53,1],[49,13,49,14,1],[50,9,50,10,1],[58,9,58,10,1],[59,13,59,46,1],[60,13,60,80,1],[65,9,65,10,1],[72,9,72,10,1],[74,13,74,41,1],[75,13,75,14,1],[76,17,76,59,1],[76,60,76,70,1],[77,13,77,14,1],[79,13,79,14,1],[80,17,80,56,1],[81,13,81,14,1],[82,13,82,33,1],[83,13,83,14,1],[85,17,85,63,1],[86,17,86,58,1],[88,13,88,27,1],[89,9,89,10,1],[92,9,92,10,1],[93,13,93,57,1],[94,13,94,27,1],[95,9,95,10,1],[15,9,15,65,1]]);
    </script>
  </body>
</html>