<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>d:\dev\lamedal\trunk\lamedalcore\lamedalcore\types\list\list_action.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using LamedalCore.zz;

namespace LamedalCore.Types.List
{
    public sealed class List_Action
    {

        /// &lt;summary&gt;Adds a range of values to the list.&lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;typeparam name=&quot;S&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;list&quot;&gt;The list.&lt;/param&gt;
        /// &lt;param name=&quot;newValues&quot;&gt;The new values.&lt;/param&gt;
        public void AddRange&lt;T, S&gt;(ICollection&lt;T&gt; list, params S[] newValues) where S : T
        {
            foreach (S value in newValues) list.Add(value);
        }

        /// &lt;summary&gt;Copies items from one list to the other list.&lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;toList&quot;&gt;The list.&lt;/param&gt;
        /// &lt;param name=&quot;fromList&quot;&gt;From list.&lt;/param&gt;
        /// &lt;param name=&quot;clearList&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [clear list].&lt;/param&gt;
        /// &lt;param name=&quot;iiStart&quot;&gt;The ii start.&lt;/param&gt;
        /// &lt;param name=&quot;iiEnd&quot;&gt;The ii end.&lt;/param&gt;
        public void Copy_From&lt;T&gt;(IList&lt;T&gt; toList, IList&lt;T&gt; fromList, bool clearList = true, int iiStart = 0, int iiEnd = -1)
        {
            Copy_To(fromList, toList, clearList, iiStart, iiEnd);
        }

        /// &lt;summary&gt;Copies array to List.&lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;toList&quot;&gt;To list.&lt;/param&gt;
        /// &lt;param name=&quot;fromArray&quot;&gt;From array.&lt;/param&gt;
        /// &lt;param name=&quot;clearList&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [clear list].&lt;/param&gt;
        public void Copy_FromArray&lt;T&gt;(List&lt;T&gt; toList, bool clearList = true, params T[] fromArray)
        {
            if (clearList) toList.Clear();
            toList.AddRange(fromArray);
        }

        /// &lt;summary&gt;
        /// Copies items from one list to the other list.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;fromList&quot;&gt;From list.&lt;/param&gt;
        /// &lt;param name=&quot;toList&quot;&gt;To list.&lt;/param&gt;
        /// &lt;param name=&quot;clearList&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [clear list].&lt;/param&gt;
        /// &lt;param name=&quot;iiStart&quot;&gt;The ii start.&lt;/param&gt;
        /// &lt;param name=&quot;iiEnd&quot;&gt;The ii end.&lt;/param&gt;
        public void Copy_To&lt;T&gt;(IList&lt;T&gt; fromList, IList&lt;T&gt; toList, bool clearList = true, int iiStart = 0, int iiEnd = -1)
        {
            // Check arguments
            if (fromList == null) throw new ArgumentNullException(nameof(fromList)); 
            if (toList == null) throw new ArgumentNullException(nameof(toList));

            if (clearList) toList.Clear();

            if (iiEnd == -1)   // Copy all from fromList
            {
                ((List&lt;T&gt;)toList).AddRange(fromList);
                return;  //&lt;========================================
            }

            // Only copy part of fromList; First make sure iiStart and iiEnd are within excepted bounds
            if (iiStart &gt; fromList.Count - 1) iiStart = fromList.Count - 1;  // Make sure iiStart is within range
            if (iiEnd &gt; fromList.Count - 1) iiEnd = fromList.Count - 1;  // Make sure iiEnd is within range
            for (var ii = iiStart; ii &lt;= iiEnd; ii++)
            {
                var item = fromList[ii];
                toList.Add(item);
            }
        }

        /// &lt;summary&gt;Merge the values from two lists.&lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;list1&quot;&gt;The list1.&lt;/param&gt;
        /// &lt;param name=&quot;list2&quot;&gt;The list2.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public IList&lt;T&gt; Merge&lt;T&gt;(IList&lt;T&gt; list1, IList&lt;T&gt; list2)
        {
            var result = new List&lt;T&gt;(list1.Count + list2.Count);
            Copy_To(list1, result);
            Copy_To(list2, result);
            return result;
        }

        /// &lt;summary&gt;
        /// Move the elements in an array.
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;list&quot;&gt;The array.&lt;/param&gt;
        /// &lt;param name=&quot;oldIndex&quot;&gt;The old index.&lt;/param&gt;
        /// &lt;param name=&quot;newIndex&quot;&gt;The new index.&lt;/param&gt;
        public void MoveElements&lt;T&gt;(IList&lt;T&gt; list, int oldIndex, int newIndex)
        {
            if (oldIndex == newIndex) return; // No-op
            var old1 = list[oldIndex];
            list[oldIndex] = list[newIndex];
            list[newIndex] = old1;
        }

        /// &lt;summary&gt;Shuffles the specified source list.&lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;source&quot;&gt;The source.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        /// &lt;exception cref=&quot;System.ArgumentNullException&quot;&gt;&lt;/exception&gt;
        public IEnumerable&lt;T&gt; Shuffle&lt;T&gt;(IEnumerable&lt;T&gt; source)
        {
            if (source == null) throw new ArgumentNullException(nameof(source));

            var rng = new Random();
            var buffer = source.ToList();
            for (int i = 0; i &lt; buffer.Count; i++)
            {
                int j = rng.Next(i, buffer.Count);
                yield return buffer[j];

                buffer[j] = buffer[i];
            }
        }

        /// &lt;summary&gt;Sorts the specified list.&lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;list&quot;&gt;The list.&lt;/param&gt;
        /// &lt;param name=&quot;acending&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [acending].&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public IList&lt;T&gt; Sort&lt;T&gt;(IList&lt;T&gt; list, bool acending = true)
        {
            if (acending) return list.OrderBy(q =&gt; q).ToList();
            return list.OrderByDescending(q =&gt; q).ToList();
        }

        /// &lt;summary&gt;Return a unique list.&lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;list&quot;&gt;The list.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        /// &lt;exception cref=&quot;System.ArgumentNullException&quot;&gt;list&lt;/exception&gt;
        public IList&lt;T&gt; Unique&lt;T&gt;(IList&lt;T&gt; list)
        {
            if (list == null) return null;   //throw new ArgumentNullException(nameof(list));

            IList&lt;T&gt; result = list.Distinct(EqualityComparer&lt;T&gt;.Default).ToList();
            return result;
        }

        /// &lt;summary&gt;Return a unique list.&lt;/summary&gt;
        /// &lt;param name=&quot;list&quot;&gt;The list.&lt;/param&gt;
        /// &lt;param name=&quot;sort&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [sort].&lt;/param&gt;
        /// &lt;param name=&quot;ignoreCase&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [ignore case].&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        /// &lt;exception cref=&quot;System.ArgumentNullException&quot;&gt;list&lt;/exception&gt;
        public IList&lt;string&gt; Unique(IList&lt;string&gt; list, bool sort = false, bool ignoreCase = false)
        {
            if (list == null) return null;   // throw new ArgumentNullException(nameof(list));

            var comparer = (ignoreCase) ? StringComparer.OrdinalIgnoreCase : StringComparer.Ordinal;
            var result = list.Distinct(comparer).ToList();
            if (sort) return Sort(result);
            return result;
        }

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[56,35,56,85,0],[57,33,57,81,0],[68,47,68,76,0],[69,45,69,72,0],[133,13,133,48,0],[133,49,133,60,0],[143,31,143,43,0],[162,13,162,27,0],[112,33,112,81,0],[133,48,133,49,0],[18,9,18,10,1],[19,13,19,20,1],[19,33,19,42,1],[19,22,19,29,1],[19,44,19,60,1],[19,30,19,32,1],[20,9,20,10,1],[30,9,30,10,1],[31,13,31,66,1],[32,9,32,10,1],[40,9,40,10,1],[41,13,41,27,1],[41,28,41,43,1],[42,13,42,40,1],[43,9,43,10,1],[54,9,54,10,1],[56,13,56,34,1],[57,13,57,32,1],[59,13,59,27,1],[59,28,59,43,1],[61,13,61,29,1],[62,13,62,14,1],[63,17,63,54,1],[64,17,64,24,1],[68,13,68,46,1],[69,13,69,44,1],[70,18,70,34,1],[71,13,71,14,1],[72,17,72,41,1],[73,17,73,34,1],[74,13,74,14,1],[70,49,70,53,1],[70,36,70,47,1],[75,9,75,10,1],[83,9,83,10,1],[84,13,84,65,1],[85,13,85,36,1],[86,13,86,36,1],[87,13,87,27,1],[88,9,88,10,1],[98,9,98,10,1],[99,13,99,38,1],[99,39,99,46,1],[100,13,100,39,1],[101,13,101,45,1],[102,13,102,35,1],[103,9,103,10,1],[131,9,131,10,1],[132,13,132,26,1],[132,27,132,52,1],[132,53,132,64,1],[134,9,134,10,1],[142,9,142,10,1],[143,13,143,30,1],[145,13,145,83,1],[146,13,146,27,1],[147,9,147,10,1],[156,9,156,10,1],[157,13,157,30,1],[157,31,157,43,1],[159,13,159,101,1],[160,13,160,59,1],[161,13,161,22,1],[161,23,161,43,1],[163,9,163,10,1],[111,9,111,10,1],[112,13,112,32,1],[114,13,114,36,1],[115,13,115,42,1],[116,18,116,27,1],[117,13,117,14,1],[118,17,118,51,1],[119,17,119,40,1],[121,17,121,39,1],[122,13,122,14,1],[116,47,116,50,1],[116,29,116,45,1],[123,9,123,10,1],[132,52,132,53,1]]);
    </script>
  </body>
</html>