<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>d:\dev\lamedal\trunk\lamedalcore\lamedalcore\types\class\class_info.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using LamedalCore.domain.Attributes;

namespace LamedalCore.Types.Class
{
    public sealed class Class_Info
    {
        /// &lt;summary&gt;Gets the class information reference.&lt;/summary&gt;
        private Class_Info_Dictionary Dictionary { get; } = new Class_Info_Dictionary();

        private readonly LamedalCore_ _lamed = LamedalCore_.Instance; // system library

        #region Singleton of Access2System_
        private static readonly Class_Info _Types_ClassInfo = new Class_Info();  // This is the only instance of this class
        private Class_Info()
        {
            // Private constructor prevents creation by external clients
        }

        /// &lt;summary&gt;
        /// Return Instance of Types_ClassInfo
        /// &lt;/summary&gt;
        public static Class_Info Instance
        {
            get { return _Types_ClassInfo; }
        }
        #endregion

        /// &lt;summary&gt;
        /// Generic blueprint rule and data caching.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;classType&quot;&gt;The class type&lt;/param&gt;
        /// &lt;returns&gt;FieldInfo[]&lt;/returns&gt;
        public Blueprint_Attributes Blueprint_Attributes(Type classType)
        {
            return Dictionary.Blueprint_Attributes(classType);
        }

        #region Properties
        /// &lt;summary&gt;Set the property of the object class to the value.&lt;/summary&gt;
        /// &lt;param name=&quot;Object&quot;&gt;The objectect&lt;/param&gt;
        /// &lt;param name=&quot;propertyName&quot;&gt;The propertyerty&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;The valueue&lt;/param&gt;
        public void Property_Set(object Object, string propertyName, object value)
        {
            var objectType = Object.GetType();
            PropertyInfo propertyInfo = Dictionary.PropertyInfo_Get(objectType, propertyName);
            var value2 = _lamed.Types.Object.CastTo(value, propertyInfo.PropertyType);
        
            propertyInfo.SetValue(Object, value2, null);
        }

        /// &lt;summary&gt;Gets the value of a property.&lt;/summary&gt;
        /// &lt;param name=&quot;Object&quot;&gt;The object.&lt;/param&gt;
        /// &lt;param name=&quot;propertyName&quot;&gt;Name of the property.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public object Property_Get(object Object, string propertyName)
        {
            PropertyInfo propertyInfo = Property_AsPropertyInfo(Object, propertyName);

            var result = propertyInfo.GetValue(Object);
            return result;
        }

        /// &lt;summary&gt;Gets the Property information.&lt;/summary&gt;
        /// &lt;param name=&quot;Object&quot;&gt;The object.&lt;/param&gt;
        /// &lt;param name=&quot;propertyName&quot;&gt;Name of the property.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public PropertyInfo Property_AsPropertyInfo(object Object, string propertyName)
        {
            Type objectType = Object.GetType();
            PropertyInfo propertyInfo = Dictionary.PropertyInfo_Get(objectType, propertyName);
            return propertyInfo;
        }

        /// &lt;summary&gt;Gets the value of a property.&lt;/summary&gt;
        /// &lt;param name=&quot;Object&quot;&gt;The object.&lt;/param&gt;
        /// &lt;param name=&quot;propertyName&quot;&gt;Name of the field.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public T Property_Get&lt;T&gt;(object Object, string propertyName)
        {
            var result = Property_Get(Object, propertyName);
            return (T) result;
        }

        /// &lt;summary&gt;Return all the property names.&lt;/summary&gt;
        /// &lt;param name=&quot;classType&quot;&gt;Type of the clas.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public List&lt;string&gt; Properties_AsStrList(Type classType)
        {
            PropertyInfo[] properties = Properties_AsPropertyInfo(classType);
            var result = properties.Select(x =&gt; x.Name).ToList();
            return result;
        }

        /// &lt;summary&gt;
        /// Generic properties for the type.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;classType&quot;&gt;The class type&lt;/param&gt;
        /// &lt;returns&gt;PropertyInfo[]&lt;/returns&gt;
        public PropertyInfo[] Properties_AsPropertyInfo(Type classType)
        {
            PropertyInfo[] properties = Dictionary.PropertyInfo_Get(classType);
            return properties;
        }

        #endregion

        #region Fields
        /// &lt;summary&gt;Set the field of the object class to the value.&lt;/summary&gt;
        /// &lt;param name=&quot;Object&quot;&gt;The object.&lt;/param&gt;
        /// &lt;param name=&quot;fieldName&quot;&gt;Name of the field.&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;The value.&lt;/param&gt;
        public void Field_Set(object Object, string fieldName, object value)
        {
            var objectType = Object.GetType();
            var fieldInfo = Dictionary.FieldInfo_Get(objectType, fieldName);
            var value2 = _lamed.Types.Object.CastTo(value, fieldInfo.FieldType);

            fieldInfo.SetValue(Object, value2);
        }

        /// &lt;summary&gt;Get the field value of the object class.&lt;/summary&gt;
        /// &lt;param name=&quot;Object&quot;&gt;The object.&lt;/param&gt;
        /// &lt;param name=&quot;fieldName&quot;&gt;Name of the field.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public object Field_Get(object Object, string fieldName)
        {
            FieldInfo fieldInfo = Field_AsFieldInfo(Object.GetType(), fieldName);
            return fieldInfo.GetValue(Object);
        }

        /// &lt;summary&gt;Gets the Field Information.&lt;/summary&gt;
        /// &lt;param name=&quot;Object&quot;&gt;The object.&lt;/param&gt;
        /// &lt;param name=&quot;fieldName&quot;&gt;Name of the field.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public FieldInfo Field_AsFieldInfo(Type classType, string fieldName)
        {
            FieldInfo fieldInfo = Dictionary.FieldInfo_Get(classType, fieldName);
            return fieldInfo;
        }

        /// &lt;summary&gt;Get the field value of the object class.&lt;/summary&gt;
        /// &lt;param name=&quot;Object&quot;&gt;The object.&lt;/param&gt;
        /// &lt;param name=&quot;fieldName&quot;&gt;Name of the field.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public T Field_Get&lt;T&gt;(object Object, string fieldName)
        {
            var result = Field_Get(Object, fieldName);
            return (T) result;
        }

        /// &lt;summary&gt;Return all the Field names.&lt;/summary&gt;
        /// &lt;param name=&quot;Object&quot;&gt;The object.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public List&lt;string&gt; Fields_AsStrList(Type classType)
        {
            var fields = Fields_AsFieldInfo(classType);
            var result = fields.Select(x =&gt; x.Name).ToList();
            return result;
        }

        /// &lt;summary&gt;
        /// Generic field information for the type.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;classType&quot;&gt;The class type&lt;/param&gt;
        /// &lt;returns&gt;FieldInfo[]&lt;/returns&gt;
        public FieldInfo[] Fields_AsFieldInfo(Type classType)
        {
            FieldInfo[] fieldInfos = Dictionary.FieldInfo_Get(classType);
            return fieldInfos;
        }
        #endregion

        #region Methods
        /// &lt;summary&gt;Return all the Method names.&lt;/summary&gt;
        /// &lt;param name=&quot;Object&quot;&gt;The object.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public List&lt;string&gt; Methods_AsStrList(Type classType)
        {
            MethodInfo[] methods = Methods_AsMethodInfo(classType);
            List&lt;string&gt; result = methods.Select(x =&gt; x.Name).ToList();
            return result;

        }

        /// &lt;summary&gt;
        /// Get the cached methods for a type
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;classType&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public MethodInfo[] Methods_AsMethodInfo(Type classType)
        {
            MethodInfo[] methods = Dictionary.MethodInfo_Get(classType);
            return methods;
        }

        /// &lt;summary&gt;Get the cached methods for a type&lt;/summary&gt;
        /// &lt;param name=&quot;classType&quot;&gt;Type of the class.&lt;/param&gt;
        /// &lt;param name=&quot;methodName&quot;&gt;Name of the method.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public MethodInfo Method_AsMethodInfo(Type classType, string methodName)
        {
            var methods = Dictionary.MethodInfo_Get(classType, methodName);
            return methods;
        }

        /// &lt;summary&gt;Executes a method.&lt;/summary&gt;
        /// &lt;param name=&quot;classObj&quot;&gt;The class object.&lt;/param&gt;
        /// &lt;param name=&quot;method&quot;&gt;The method.&lt;/param&gt;
        /// &lt;param name=&quot;parameters&quot;&gt;The parameters.&lt;/param&gt;
        public void Method_Execute(object classObj, MethodInfo method, params object[] parameters)
        {
            if (method != null) method.Invoke(classObj, parameters);
        }
        #endregion

        /// &lt;summary&gt;
        /// Get the cached methods for a type
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;classType&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public ConstructorInfo[] Constructors_AsConstructorInfo(Type classType)
        {
            ConstructorInfo[] constructors = Dictionary.ConstructorInfo_Get(classType);
            return constructors;
        }

        /// &lt;summary&gt;Gets the Field Information.&lt;/summary&gt;
        /// &lt;param name=&quot;classType&quot;&gt;Type of the class.&lt;/param&gt;
        /// &lt;param name=&quot;constructorName&quot;&gt;Name of the field.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public ConstructorInfo Constructor_AsConstructorInfo(Type classType, string constructorName)
        {
            ConstructorInfo result = Dictionary.ConstructorInfo_Get(classType, constructorName);
            return result;
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[12,52,12,56,1],[12,61,12,88,1],[14,9,14,70,1],[18,9,18,29,1],[19,9,19,10,1],[21,9,21,10,1],[28,17,28,18,1],[28,19,28,43,1],[28,44,28,45,1],[38,9,38,10,1],[39,13,39,63,1],[40,9,40,10,1],[48,9,48,10,1],[49,13,49,47,1],[50,13,50,95,1],[51,13,51,87,1],[53,13,53,57,1],[54,9,54,10,1],[61,9,61,10,1],[62,13,62,87,1],[64,13,64,56,1],[65,13,65,27,1],[66,9,66,10,1],[73,9,73,10,1],[74,13,74,48,1],[75,13,75,95,1],[76,13,76,33,1],[77,9,77,10,1],[84,9,84,10,1],[85,13,85,61,1],[86,13,86,31,1],[87,9,87,10,1],[93,9,93,10,1],[94,13,94,78,1],[95,13,95,49,1],[95,55,95,66,1],[96,13,96,27,1],[97,9,97,10,1],[105,9,105,10,1],[106,13,106,80,1],[107,13,107,31,1],[108,9,108,10,1],[118,9,118,10,1],[119,13,119,47,1],[120,13,120,77,1],[121,13,121,81,1],[123,13,123,48,1],[124,9,124,10,1],[131,9,131,10,1],[132,13,132,82,1],[133,13,133,47,1],[134,9,134,10,1],[141,9,141,10,1],[142,13,142,82,1],[143,13,143,30,1],[144,9,144,10,1],[151,9,151,10,1],[152,13,152,55,1],[153,13,153,31,1],[154,9,154,10,1],[160,9,160,10,1],[161,13,161,56,1],[162,13,162,45,1],[162,51,162,62,1],[163,13,163,27,1],[164,9,164,10,1],[172,9,172,10,1],[173,13,173,74,1],[174,13,174,31,1],[175,9,175,10,1],[183,9,183,10,1],[184,13,184,68,1],[185,13,185,55,1],[185,61,185,72,1],[186,13,186,27,1],[188,9,188,10,1],[196,9,196,10,1],[197,13,197,73,1],[198,13,198,28,1],[199,9,199,10,1],[206,9,206,10,1],[207,13,207,76,1],[208,13,208,28,1],[209,9,209,10,1],[216,9,216,10,1],[217,13,217,32,1],[217,33,217,69,1],[218,9,218,10,1],[227,9,227,10,1],[228,13,228,88,1],[229,13,229,33,1],[230,9,230,10,1],[237,9,237,10,1],[238,13,238,97,1],[239,13,239,27,1],[240,9,240,10,1],[17,9,17,80,1],[95,49,95,55,1],[162,45,162,51,1],[185,55,185,61,1]]);
    </script>
  </body>
</html>