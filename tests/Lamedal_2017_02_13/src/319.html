<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>d:\dev\lamedal\trunk\lamedalcore\lamedalcore\lib\solutionnt\classnt\classntattributes\classntattributes_methods.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using LamedalCore.domain.Attributes;
using LamedalCore.domain.Enumerals;
using LamedalCore.zz;

namespace LamedalCore.lib.SolutionNT.ClassNT.ClassNTAttributes
{
    [BlueprintRule_Class(enBlueprintClassNetworkType.VS_Static)]
    public static class ClassNTAttributes_Methods
    {
        /// &lt;summary&gt;
        /// For an attribute this method will seperate its name and Parameters.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;attributeCode&quot;&gt;The attribute code&lt;/param&gt;
        /// &lt;param name=&quot;attributeName&quot;&gt;Return the attribute name&lt;/param&gt;
        /// &lt;param name=&quot;parameterStrList&quot;&gt;Return the parameter string list&lt;/param&gt;
        public static void Attribute_Parts(string attributeCode, out string attributeName, out List&lt;string&gt; parameterStrList)
        {
            attributeName = &quot;&quot;;
            parameterStrList = new List&lt;string&gt;();

            if (attributeCode.zContains_All(&quot;[&quot;, &quot;]&quot;) == false) (&quot;Error! No attribute input parameter: &#39;{0}&#39;&quot;.zFormat(attributeCode)).zException_Show();

            attributeCode = attributeCode.Replace(&quot;[&quot;, &quot;&quot;).Replace(&quot;]&quot;, &quot;&quot;);  //.Replace(&quot;(&quot;, &quot; &quot;).Replace(&quot;)&quot;, &quot;&quot;);
            if (attributeCode.zContains_Any(&quot; &quot;, &quot;(&quot;) == false)
            {
                attributeName = attributeCode;
                return;
            }

            attributeName = &quot;(&quot;.zVar_Next(ref attributeCode);
            attributeCode = attributeCode.zSubStr_RemoveLastWord(&quot;)&quot;);

            while (attributeCode != &quot;&quot;)
            {
                var parameter = &quot;,&quot;.zVar_Next(ref attributeCode);
                parameterStrList.Add(parameter);
            }
        }

        /// &lt;summary&gt;
        /// Parse code lines and seperate each attribute from the other. Every line in the list will contain 1 and only 1 attribute.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sourceCode&quot;&gt;The source code list&lt;/param&gt;
        /// &lt;returns&gt;List&lt;string/&gt;&lt;/returns&gt;
        public static List&lt;string&gt; Attributes_FromCode(List&lt;string&gt; sourceCode)
        {
            var attributeLines = new List&lt;string&gt;();
            var line = &quot;&quot;;
            foreach (string code in sourceCode)
            {
                line += code.Trim();
                if (code.Contains(&quot;]&quot;) == false) continue;

                attributeLines.AddRange(Attributes_FromCodeLine(line));
                line = &quot;&quot;;
            }
            return attributeLines;
        }

        public static List&lt;string&gt; Attributes_FromCodeLine(string line)
        {
            // Is there more than one attribute in the same line -&gt; split the lines
            var attributes = new List&lt;string&gt;();
            List&lt;string&gt; attributeTest = line.zConvert_Str_ToListStr(&quot;,&quot;);
            string att = &quot;&quot;;
            bool combine = false;
            int BraketOpen, BraketClose;
            foreach (string attTest in attributeTest)
            {
                var attTest2 = attTest.Trim();
                if (combine == false)
                {
                    if (attTest2.zContains_Any(&quot;(&quot;, &quot;)&quot;) == false)
                    {
                        attributes.Add(attTest2);
                        continue;
                    }

                    if (attTest2.zContains_All(&quot;(&quot;, &quot;)&quot;))
                    {
                        BraketOpen = attTest2.zWord_Total(&quot;(&quot;);
                        BraketClose = attTest2.zWord_Total(&quot;)&quot;);
                        if (BraketOpen == BraketClose)
                        {
                            // [BlueprintCodeInjection_(typeof(Controller_BlueprintLogger)   ==&gt; should not be a positive
                            attributes.Add(attTest2);
                            continue;                            
                        }
                    }
                }
                // Combine all attribute parameters
                combine = true;
                if (att != &quot;&quot;) att += &quot;, &quot;;
                att += attTest2;

                if (att.zContains(&quot;)&quot;))
                {
                    BraketOpen = att.zWord_Total(&quot;(&quot;);
                    BraketClose = att.zWord_Total(&quot;)&quot;);
                    if (BraketOpen == BraketClose)
                    {

                        attributes.Add(att);
                        att = &quot;&quot;;
                        combine = false;
                    }
                }
            }

            if (attributes.Count &gt; 1)
            {
                for (int ii = 0; ii &lt; attributes.Count; ii++)
                {
                    if (ii &gt; 0) attributes[ii] = &quot;[&quot; + attributes[ii];
                    if (attributes[ii].zContains(&quot;(&quot;) &amp;&amp; attributes[ii].zContains(&quot;)&quot;) == false) attributes[ii] += &quot;)&quot;;  // unable to test this condition - add test case
                    if (attributes[ii].zContains(&quot;]&quot;) == false) attributes[ii] += &quot;]&quot;;
                }
            }
            return attributes;
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[116,98,116,120,0],[18,9,18,10,1],[19,13,19,32,1],[20,13,20,51,1],[22,13,22,64,1],[22,65,22,153,1],[24,13,24,77,1],[25,13,25,64,1],[26,13,26,14,1],[27,17,27,47,1],[28,17,28,24,1],[31,13,31,62,1],[32,13,32,71,1],[35,13,35,14,1],[36,17,36,66,1],[37,17,37,49,1],[38,13,38,14,1],[34,13,34,40,1],[39,9,39,10,1],[47,9,47,10,1],[48,13,48,53,1],[49,13,49,27,1],[50,13,50,20,1],[50,37,50,47,1],[50,22,50,33,1],[51,13,51,14,1],[52,17,52,37,1],[53,17,53,49,1],[53,50,53,59,1],[55,17,55,72,1],[56,17,56,27,1],[57,13,57,14,1],[50,34,50,36,1],[58,13,58,35,1],[59,9,59,10,1],[62,9,62,10,1],[64,13,64,49,1],[65,13,65,75,1],[66,13,66,29,1],[67,13,67,34,1],[69,13,69,20,1],[69,40,69,53,1],[69,22,69,36,1],[70,13,70,14,1],[71,17,71,47,1],[72,17,72,38,1],[73,17,73,18,1],[74,21,74,67,1],[75,21,75,22,1],[76,25,76,50,1],[77,25,77,34,1],[80,21,80,58,1],[81,21,81,22,1],[82,25,82,64,1],[83,25,83,65,1],[84,25,84,55,1],[85,25,85,26,1],[87,29,87,54,1],[88,29,88,38,1],[90,21,90,22,1],[91,17,91,18,1],[93,17,93,32,1],[94,17,94,31,1],[94,32,94,44,1],[95,17,95,33,1],[97,17,97,40,1],[98,17,98,18,1],[99,21,99,55,1],[100,21,100,56,1],[101,21,101,51,1],[102,21,102,22,1],[104,25,104,45,1],[105,25,105,34,1],[106,25,106,41,1],[107,21,107,22,1],[108,17,108,18,1],[109,13,109,14,1],[69,37,69,39,1],[111,13,111,38,1],[112,13,112,14,1],[113,22,113,32,1],[114,17,114,18,1],[115,21,115,32,1],[115,33,115,71,1],[116,21,116,97,1],[117,21,117,64,1],[117,65,117,87,1],[118,17,118,18,1],[113,57,113,61,1],[113,34,113,55,1],[119,13,119,14,1],[120,13,120,31,1],[121,9,121,10,1]]);
    </script>
  </body>
</html>